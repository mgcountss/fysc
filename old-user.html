<html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="stylesheet" href="./odometer.css">
<script src="./odometer.js"></script>
<link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,400;0,700;1,400&amp;display=swap">
<script src="https://code.highcharts.com/stock/highstock.js"></script>
<style>
    .highcharts-title {
        color: #FFFFFF
    }

    .body {
        text-align: center;
        font-family: 'Open Sans', sans-serif;
        background-color: #222;
        color: #FFF;
        font-size: 2vw;
        margin-top: 0px;
    }
</style>

<body class="body">
    <center>
        <br>
        <img id="img" style="border-radius: 50%; width: 10vw; height: 10vw;" src="../loading.png">
        <h1 id="namer" style="margin-top: 0.5vw;">Loading</h1>
        <h1 id="odometer" style="font-size: 8vw; margin-top: -1vw;" class="odometer">0</h1>
        <hr style="background-color: #FFF;">
        <h6>Subscribers Since Page Opened</h6>
        <div id="chart" style="height: 30vw; width: 100%; color: #000000;"></div>
        <hr style="background-color: #FFF;">
        <div style="display: grid; grid-template-columns: repeat(3, 1fr);">
            <div style="text-align: center;">
                <h6>Videos</h6>
                <h1 id="videos" style="font-size: 4vw; margin-top: -2vw;" class="odometer">0</h1>
            </div>
            <div style="text-align: center;">
                <h6>Commands</h6>
                <h1 id="commands" style="font-size: 4vw; margin-top: -2vw;" class="odometer">0</h1>
            </div>
            <div style="text-align: center;">
                <h6>Streams</h6>
                <h1 id="streams" style="font-size: 4vw; margin-top: -2vw;" class="odometer">0</h1>
            </div>
            <div style="text-align: center;">
                <h6>Shorts</h6>
                <h1 id="shorts" style="font-size: 4vw; margin-top: -2vw;" class="odometer">0</h1>
            </div>
            <div style="text-align: center;">
                <h6>Songs</h6>
                <h1 id="songs" style="font-size: 4vw; margin-top: -2vw;" class="odometer">0</h1>
            </div>
            <div style="text-align: center;">
                <h6>Comments</h6>
                <h1 id="comments" style="font-size: 4vw; margin-top: -2vw;" class="odometer">0</h1>
            </div>
            <div style="text-align: center;">
                <h6>Playlists</h6>
                <h1 id="playlists" style="font-size: 4vw; margin-top: -2vw;" class="odometer">0</h1>
            </div>
            <div style="text-align: center;">
                <h6>Posts</h6>
                <h1 id="posts" style="font-size: 4vw; margin-top: -2vw;" class="odometer">0</h1>
            </div>
            <div style="text-align: center;">
                <h6>Last MSG</h6>
                <h1 id="last" style="font-size: 2vw; margin-top: -2vw;">0</h1>
            </div>
        </div>
        <hr>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr);">
            <div style="border: solid 1px #FFF;">
                <h6>Subscribers</h6>
                <div id="chart1" style="height: 20vw; width: 100%; color: #000000;"></div>
            </div>
            <div style="border: solid 1px #FFF;">
                <h6>Videos</h6>
                <div id="chart2" style="height: 20vw; width: 100%; color: #000000;"></div>
            </div>
            <div style="border: solid 1px #FFF;">
                <h6>Commands</h6>
                <div id="chart3" style="height: 20vw; width: 100%; color: #000000;"></div>
            </div>
            <div style="border: solid 1px #FFF;">
                <h6>Streams</h6>
                <div id="chart4" style="height: 20vw; width: 100%; color: #000000;"></div>
            </div>
            <div style="border: solid 1px #FFF;">
                <h6>Shorts</h6>
                <div id="chart5" style="height: 20vw; width: 100%; color: #000000;"></div>
            </div>
            <div style="border: solid 1px #FFF;">
                <h6>Songs</h6>
                <div id="chart6" style="height: 20vw; width: 100%; color: #000000;"></div>
            </div>
            <div style="border: solid 1px #FFF;">
                <h6>Comments</h6>
                <div id="chart7" style="height: 20vw; width: 100%; color: #000000;"></div>
            </div>
            <div style="border: solid 1px #FFF;">
                <h6>Playlists</h6>
                <div id="chart8" style="height: 20vw; width: 100%; color: #000000;"></div>
            </div>
            <div style="border: solid 1px #FFF;">
                <h6>Posts</h6>
                <div id="chart9" style="height: 20vw; width: 100%; color: #000000;"></div>
            </div>
        </div>
        <br>
        <div class="table-responsive" style="border: solid 1px #FFF;">
            <table style="width: 100%;">
                <thead>
                    <tr>
                        <th style="border: solid 1px #FFF;">Date</th>
                        <th style="border: solid 1px #FFF;">Total Subscribers</th>
                        <th style="border: solid 1px #FFF;">Subscriber Gain</th>
                        <th style="border: solid 1px #FFF;">Total Videos</th>
                        <th style="border: solid 1px #FFF;">Videos Gain</th>
                        <th style="border: solid 1px #FFF;">Total Commands</th>
                        <th style="border: solid 1px #FFF;">Commands Gain</th>
                        <th style="border: solid 1px #FFF;">Total Streams</th>
                        <th style="border: solid 1px #FFF;">Streams Gain</th>
                        <th style="border: solid 1px #FFF;">Total Shorts</th>
                        <th style="border: solid 1px #FFF;">Shorts Gain</th>
                        <th style="border: solid 1px #FFF;">Total Songs</th>
                        <th style="border: solid 1px #FFF;">Songs Gain</th>
                        <th style="border: solid 1px #FFF;">Total Comments</th>
                        <th style="border: solid 1px #FFF;">Comments Gain</th>
                        <th style="border: solid 1px #FFF;">Total Playlists</th>
                        <th style="border: solid 1px #FFF;">Playlists Gain</th>
                        <th style="border: solid 1px #FFF;">Total Posts</th>
                        <th style="border: solid 1px #FFF;">Posts Gain</th>
                    </tr>
                </thead>
                <tbody style="border-style: none;" class="counters"></tbody>
            </table>
        </div>

    </center>
</body>
<script>
    var params = new URLSearchParams(document.location.search.substring(1));
    var id = params.get("id");
    var tags = [];
    let loaded = false;
    let chartData1 = [];
    let chartData2 = [];
    let chartData3 = [];
    let chartData4 = [];
    let chartData5 = [];
    let chartData6 = [];
    let chartData7 = [];
    let chartData8 = [];
    let chartData9 = [];
    function subs() {
        $.getJSON("/user/" + id + "", (data) => {
            document.getElementById('img').src = data.image
            document.getElementById('namer').innerHTML = data.name
            document.getElementById('odometer').innerHTML = Math.floor(data.subs)
            document.getElementById('videos').innerHTML = data.videos
            document.getElementById('commands').innerHTML = data.commands
            document.getElementById('streams').innerHTML = data.streams
            document.getElementById('shorts').innerHTML = data.shorts
            document.getElementById('songs').innerHTML = data.songs
            document.getElementById('comments').innerHTML = data.comments
            document.getElementById('playlists').innerHTML = data.playlists
            document.getElementById('posts').innerHTML = data.posts
            document.getElementById('last').innerHTML = new Date(data.lastMSG)
            if (chart.series[0].points.length == 1500) chart.series[0].data[0].remove();
            chart.series[0].addPoint([Date.now(), Math.floor(data.subs)])
            if (loaded == false) {
                for (let q = 0; q < data.list.length; q++) {
                    data.list[q][0] = data.list[q][0].split('/')[0] + "/" + (parseFloat(data.list[q][0].split('/')[1]) + 1).toString() + '/' + data.list[q][0].split('/')[2].replace('at', 'at the') + " hour (CST)"
                    let subGain = 0;
                    let commandGain = 0;
                    let videoGain = 0;
                    let shortGain = 0;
                    let streamGain = 0;
                    let songGain = 0;
                    let commentGain = 0;
                    let playlistGain = 0;
                    let postGain = 0;
                    if (data.list[q-1]) {
                        subGain = Math.floor(data.list[q][1]) - Math.floor(data.list[q-1][1])
                        videoGain = data.list[q][2] - data.list[q-1][2]
                        commandGain = data.list[q][3] - data.list[q-1][3]
                        streamGain = data.list[q][4] - data.list[q-1][4]
                        shortGain = data.list[q][5] - data.list[q-1][5]
                        songGain = data.list[q][6] - data.list[q-1][6]
                        commentGain = data.list[q][7] - data.list[q-1][7]
                        playlistGain = data.list[q][8] - data.list[q-1][8]
                        postGain = data.list[q][9] - data.list[q-1][9]
                    }
                    var htmlcard = `<tr>
                    <td style="border: solid 1px #FFF;" id="date_${q}">${data.list[q][0]}</td>
                        <td style="border: solid 1px #FFF;" id="subs_${q}">${Math.floor(data.list[q][1]).toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="subgain_${q}">${Math.floor(subGain).toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="videos_${q}">${data.list[q][3].toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="videoGain_${q}">${videoGain.toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="commands_${q}">${data.list[q][2].toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="commandgain_${q}">${commandGain.toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="streams_${q}">${data.list[q][5].toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="streamgain_${q}">${streamGain.toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="shorts_${q}">${data.list[q][4].toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="shortgain_${q}">${shortGain.toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="songs_${q}">${data.list[q][6].toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="songgain_${q}">${songGain.toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="comments_${q}">${data.list[q][7].toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="commentgain_${q}">${commentGain.toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="playlists_${q}">${data.list[q][8].toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="playlistgain_${q}">${playlistGain.toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="posts_${q}">${data.list[q][9].toLocaleString()}</td>
                        <td style="border: solid 1px #FFF;" id="postgain_${q}">${postGain.toLocaleString()}</td>
                    </tr>`;
                    $('.counters').append(htmlcard)
                    chartData1.push([data.list[q][0], Math.floor(data.list[q][1])])
                    chartData2.push([data.list[q][0], data.list[q][2]])
                    chartData3.push([data.list[q][0], data.list[q][3]])
                    chartData4.push([data.list[q][0], data.list[q][4]])
                    chartData5.push([data.list[q][0], data.list[q][5]])
                    chartData6.push([data.list[q][0], data.list[q][6]])
                    chartData7.push([data.list[q][0], data.list[q][7]])
                    chartData8.push([data.list[q][0], data.list[q][8]])
                    chartData9.push([data.list[q][0], data.list[q][9]])
                }
                loaded = true;
                let chart1 = new Highcharts.chart({
                    chart: {
                        renderTo: 'chart1',
                        type: 'spline',
                        zoomType: 'x',
                        backgroundColor: 'transparent',
                        plotBorderColor: 'transparent'
                    },
                    title: {
                        text: ' '
                    },
                    credits: {
                        enabled: false,
                    }, xAxis: {
                        type: 'datetime',
                        visible: false
                    },
                    yAxis: {
                        visible: false,
                    },
                    plotOptions: {
                        series: {
                            threshold: null,
                            fillOpacity: 0.25
                        },
                        area: {
                            fillOpacity: 0.25
                        }
                    },
                    series: [{
                        showInLegend: false,
                        name: 'Subscribers',
                        marker: { enabled: false },
                        color: '#FFF',
                        lineColor: '#FFF',
                        lineWidth: 2,
                        data: chartData1
                    }]
                });
          
                let chart2 = new Highcharts.chart({
                    chart: {
                        renderTo: 'chart2',
                        type: 'spline',
                        zoomType: 'x',
                        backgroundColor: 'transparent',
                        plotBorderColor: 'transparent'
                    },
                    title: {
                        text: ' '
                    },
                    credits: {
                        enabled: false,
                    }, xAxis: {
                        type: 'datetime',
                        visible: false
                    },
                    yAxis: {
                        visible: false,
                    },
                    plotOptions: {
                        series: {
                            threshold: null,
                            fillOpacity: 0.25
                        },
                        area: {
                            fillOpacity: 0.25
                        }
                    },
                    series: [{
                        showInLegend: false,
                        name: 'Videos',
                        marker: { enabled: false },
                        color: '#FFF',
                        lineColor: '#FFF',
                        lineWidth: 2,
                        data: chartData2
                    }]
                });
          
                let chart3 = new Highcharts.chart({
                    chart: {
                        renderTo: 'chart3',
                        type: 'spline',
                        zoomType: 'x',
                        backgroundColor: 'transparent',
                        plotBorderColor: 'transparent'
                    },
                    title: {
                        text: ' '
                    },
                    credits: {
                        enabled: false,
                    }, xAxis: {
                        type: 'datetime',
                        visible: false
                    },
                    yAxis: {
                        visible: false,
                    },
                    plotOptions: {
                        series: {
                            threshold: null,
                            fillOpacity: 0.25
                        },
                        area: {
                            fillOpacity: 0.25
                        }
                    },
                    series: [{
                        showInLegend: false,
                        name: 'Commands',
                        marker: { enabled: false },
                        color: '#FFF',
                        lineColor: '#FFF',
                        lineWidth: 2,
                        data: chartData3
                    }]
                });
          
                let chart4 = new Highcharts.chart({
                    chart: {
                        renderTo: 'chart4',
                        type: 'spline',
                        zoomType: 'x',
                        backgroundColor: 'transparent',
                        plotBorderColor: 'transparent'
                    },
                    title: {
                        text: ' '
                    },
                    credits: {
                        enabled: false,
                    }, xAxis: {
                        type: 'datetime',
                        visible: false
                    },
                    yAxis: {
                        visible: false,
                    },
                    plotOptions: {
                        series: {
                            threshold: null,
                            fillOpacity: 0.25
                        },
                        area: {
                            fillOpacity: 0.25
                        }
                    },
                    series: [{
                        showInLegend: false,
                        name: 'Streams',
                        marker: { enabled: false },
                        color: '#FFF',
                        lineColor: '#FFF',
                        lineWidth: 2,
                        data: chartData4
                    }]
                });
          
                let chart5 = new Highcharts.chart({
                    chart: {
                        renderTo: 'chart5',
                        type: 'spline',
                        zoomType: 'x',
                        backgroundColor: 'transparent',
                        plotBorderColor: 'transparent'
                    },
                    title: {
                        text: ' '
                    },
                    credits: {
                        enabled: false,
                    }, xAxis: {
                        type: 'datetime',
                        visible: false
                    },
                    yAxis: {
                        visible: false,
                    },
                    plotOptions: {
                        series: {
                            threshold: null,
                            fillOpacity: 0.25
                        },
                        area: {
                            fillOpacity: 0.25
                        }
                    },
                    series: [{
                        showInLegend: false,
                        name: 'Shorts',
                        marker: { enabled: false },
                        color: '#FFF',
                        lineColor: '#FFF',
                        lineWidth: 2,
                        data: chartData5
                    }]
                });
          
                let chart6 = new Highcharts.chart({
                    chart: {
                        renderTo: 'chart6',
                        type: 'spline',
                        zoomType: 'x',
                        backgroundColor: 'transparent',
                        plotBorderColor: 'transparent'
                    },
                    title: {
                        text: ' '
                    },
                    credits: {
                        enabled: false,
                    }, xAxis: {
                        type: 'datetime',
                        visible: false
                    },
                    yAxis: {
                        visible: false,
                    },
                    plotOptions: {
                        series: {
                            threshold: null,
                            fillOpacity: 0.25
                        },
                        area: {
                            fillOpacity: 0.25
                        }
                    },
                    series: [{
                        showInLegend: false,
                        name: 'Songs',
                        marker: { enabled: false },
                        color: '#FFF',
                        lineColor: '#FFF',
                        lineWidth: 2,
                        data: chartData6
                    }]
                });
          
          
                let chart7 = new Highcharts.chart({
                    chart: {
                        renderTo: 'chart7',
                        type: 'spline',
                        zoomType: 'x',
                        backgroundColor: 'transparent',
                        plotBorderColor: 'transparent'
                    },
                    title: {
                        text: ' '
                    },
                    credits: {
                        enabled: false,
                    }, xAxis: {
                        type: 'datetime',
                        visible: false
                    },
                    yAxis: {
                        visible: false,
                    },
                    plotOptions: {
                        series: {
                            threshold: null,
                            fillOpacity: 0.25
                        },
                        area: {
                            fillOpacity: 0.25
                        }
                    },
                    series: [{
                        showInLegend: false,
                        name: 'Comments',
                        marker: { enabled: false },
                        color: '#FFF',
                        lineColor: '#FFF',
                        lineWidth: 2,
                        data: chartData7
                    }]
                });
          
          
                let chart8 = new Highcharts.chart({
                    chart: {
                        renderTo: 'chart8',
                        type: 'spline',
                        zoomType: 'x',
                        backgroundColor: 'transparent',
                        plotBorderColor: 'transparent'
                    },
                    title: {
                        text: ' '
                    },
                    credits: {
                        enabled: false,
                    }, xAxis: {
                        type: 'datetime',
                        visible: false
                    },
                    yAxis: {
                        visible: false,
                    },
                    plotOptions: {
                        series: {
                            threshold: null,
                            fillOpacity: 0.25
                        },
                        area: {
                            fillOpacity: 0.25
                        }
                    },
                    series: [{
                        showInLegend: false,
                        name: 'Playlists',
                        marker: { enabled: false },
                        color: '#FFF',
                        lineColor: '#FFF',
                        lineWidth: 2,
                        data: chartData8
                    }]
                });
          
          
                let chart9 = new Highcharts.chart({
                    chart: {
                        renderTo: 'chart9',
                        type: 'spline',
                        zoomType: 'x',
                        backgroundColor: 'transparent',
                        plotBorderColor: 'transparent'
                    },
                    title: {
                        text: ' '
                    },
                    credits: {
                        enabled: false,
                    }, xAxis: {
                        type: 'datetime',
                        visible: false
                    },
                    yAxis: {
                        visible: false,
                    },
                    plotOptions: {
                        series: {
                            threshold: null,
                            fillOpacity: 0.25
                        },
                        area: {
                            fillOpacity: 0.25
                        }
                    },
                    series: [{
                        showInLegend: false,
                        name: 'Posts',
                        marker: { enabled: false },
                        color: '#FFF',
                        lineColor: '#FFF',
                        lineWidth: 2,
                        data: chartData9
                    }]
                });
          
            }
        });
    }

    let chart = new Highcharts.chart({
        chart: {
            renderTo: 'chart',
            type: 'areaspline',
            zoomType: 'x',
            backgroundColor: 'transparent',
            plotBorderColor: 'transparent'
        },
        title: {
            text: ' '
        },
        credits: {
            enabled: false,
        }, xAxis: {
            type: 'datetime',
            visible: false
        },
        yAxis: {
            visible: false,
        },
        plotOptions: {
            series: {
                threshold: null,
                fillOpacity: 0.25
            },
            area: {
                fillOpacity: 0.25
            }
        },
        series: [{
            showInLegend: false,
            name: 'Subscribers',
            marker: { enabled: false },
            color: '#FFF',
            lineColor: '#FFF',
            lineWidth: 2,
        }]
    });

    subs()
    setInterval(subs, 2000)
</script>


</html>